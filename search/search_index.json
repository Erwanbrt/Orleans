{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Bienvenue sur la documentation du projet SportLudique Orleans.","text":""},{"location":"#contexte-du-projet","title":"Contexte du projet","text":"<p>Dans le cadre de notre formation en BTS Services Informatiques aux Organisations (SIO), option Solutions d\u2019Infrastructure, Syst\u00e8mes et R\u00e9seaux (SISR), nous avons pour mission de concevoir une infrastructure r\u00e9seau compl\u00e8te pour l\u2019entreprise SportLudique. Ce projet est une composante cl\u00e9 de notre \u00e9valuation en deuxi\u00e8me ann\u00e9e (SIO2).</p> <p>Nous sommes un groupe de trois \u00e9tudiants : - Erwan BRIET - Elouenn ROUSSEAU - Kevin SOULIER</p>"},{"location":"#presentation-de-lentreprise","title":"Pr\u00e9sentation de l'entreprise","text":"<p>SportLudique est une entreprise sp\u00e9cialis\u00e9e dans la cr\u00e9ation et la production d\u2019articles de sports non conventionnels. Elle est r\u00e9partie sur quatre sites distants : - Chartres - Tours - Orl\u00e9ans - Ch\u00e2teauroux</p> <p>L'ensemble de l'infrastructure r\u00e9seau et informatique de SportLudique est g\u00e9r\u00e9e par le d\u00e9partement Solutions d'Infrastructure Syst\u00e8me et R\u00e9seau (SISR). Ce d\u00e9partement a pour responsabilit\u00e9 : - L'exploitation et la maintenance du parc d'\u00e9quipements. - La gestion des projets informatiques de l'entreprise.</p> <p>Cette documentation pr\u00e9sente en d\u00e9tail la conception et la mise en \u0153uvre de l\u2019infrastructure r\u00e9seau propos\u00e9e pour SportLudique. Vous y trouverez les diff\u00e9rentes \u00e9tapes du projet, les choix techniques, ainsi que les solutions mises en place pour r\u00e9pondre aux besoins de l'entreprise.</p>"},{"location":"Brouillon/","title":"Brouillon","text":"<ul> <li>les firewall en routeur avec ajout des interfaces </li> <li>la partie DCHP de erwan </li> </ul>"},{"location":"Certificat-ssl/","title":"Certificat SSL","text":"<p>afin de securiser notre r\u00e9seau de potentiel visites de  site web interdit nous allons utiliser du filtrage applicatif </p>"},{"location":"Certificat-ssl/#pour-cela-nous-allons-configurer-differents-services","title":"Pour cela nous allons configurer diff\u00e9rents services :","text":""},{"location":"Certificat-ssl/#creation-dune-base-durl","title":"Cr\u00e9ation d'une base d'URL :","text":""},{"location":"Certificat-ssl/#nous-avons-creer-une-categorie-black_list-et-nous-avons-ajouter-des-url-interdit-comme-par-exemple-en-ecrivant-dans-la-fenetre-suivante","title":"nous avons cr\u00e9er une cat\u00e9gorie \"Black_List\" et nous avons ajouter des URL interdit comme par exemple en ecrivant dans la fen\u00e8tre suivante","text":""},{"location":"Certificat-ssl/#nous-allons-maintenant-ajouter-notre-categorie-black_list-dans-nos-politique-de-filtrage-url","title":"Nous allons maintenant ajouter notre categorie Black_List dans nos politique de filtrage URL.","text":"<p>Nous avons selectionner l'affichage de la \"BlockPage_00\" pour tout URL pr\u00e9sent dans la cat\u00e9gorie \"Black_List\".</p> <p></p>"},{"location":"Certificat-ssl/#et-quand-nous-essayons-dentrer-sur-le-site-de-youtbe-nous-avons-cette-page","title":"Et quand nous essayons d'entrer sur le site de youtbe nous avons cette page :","text":""},{"location":"Certificat-ssl/#nous-allons-maintenant-ajouter-le-certificat-du-stromshield","title":"Nous allons maintenant ajouter le certificat du stromshield.","text":""},{"location":"Certificat-ssl/#afin-dacceder-a-internet-depuis-notre-lan-nous-devons-avoir-le-certificat-du-stormshield-sur-le-poste-sinon-cette-page-apparait","title":"Afin d'acceder \u00e0 internet depuis notre LAN nous devons avoir le certificat du Stormshield sur le poste sinon cette page apparait :","text":""},{"location":"Certificat-ssl/#sur-le-stormshield-nous-allons-donc-aller-chercher-le-certificat","title":"Sur le Stormshield nous allons donc aller chercher le certificat.","text":"<p>Dans  Configuration/Objet/Certificat et PKI.   Puis on selectionne le certificat du FireWall et on le t\u00e9l\u00e9charge. </p>"},{"location":"Certificat-ssl/#une-fois-que-nous-avons-notre-certificat-nous-allons-deployer-une-gpo-afin-que-nos-utilisateurs-puissent-acceder-aux-differents-sites-web","title":"une fois que nous avons notre certificat nous allons deployer une GPO afin que nos utilisateurs puissent acc\u00e9der aux diff\u00e9rents sites web .","text":"<p>Nous allons donc aller dans l'outils de gestion de strat\u00e9gies de groupe puis Objet de strat\u00e9gies de groupe</p> <p></p> <p>Dans les Objet de strat\u00e9gies de groupe cr\u00e9er une nouvelle strat\u00e9gie et nommer l\u00e0 :</p> <p>Nous allons faire un clique droit sur la strat\u00e9gie puis nous allons naviguer dans :  Configuration Ordinateur / Strat\u00e9gies / Param\u00e8tres Windows / Param\u00e8tres de s\u00e9curit\u00e9 / strat\u00e9gies de cl\u00e9 publique   </p> <p>En faisant un clique droit sur Autorit\u00e9s de certification racines de confiance nous pouvons cliquer sur Importer </p> <p>Dans l'assistant cliquer sur Suivant puis choisir notre certificat dans Parcourir puis cliquer sur suivant jusqu'a ce que l'assistant se ferme. </p> <p>Maintenant que le certifiat importer nous allons d\u00e9finir que l'on applique la r\u00e9gle sur les ordinateurs du domaine :</p> <p></p> <p>Maintenant notre GPO est cr\u00e9er nous allons donc pouvoir l'attribuer au groupe d'utilisateurs souhaiter en faisant un clique droit sur le groupe puis nous allons cliquer sur  Lier un objet de strat\u00e9gie de groupe existant...</p> <p></p> <p>Puis on selectionne la trat\u00e9gie que l'on vient de cr\u00e9er dans le groupe et on clique sur OK pour valider."},{"location":"Certificat-ssl/#nous-allons-maintenant-pouvoir-tester-sur-un-utilisateur-de-lad","title":"Nous allons maintenant pouvoir tester sur un utilisateur de l'AD.","text":"<p>En essayant d'acc\u00e9der au site  Amazon depuis Edge nous pouvons voir que le FireWall apparait dans l'autorit\u00e9 de certification.</p> <p></p>"},{"location":"Conf-Coeur-de-r%C3%A9seau/","title":"Configuration","text":""},{"location":"Conf-Coeur-de-r%C3%A9seau/#lequipement","title":"L'\u00e9quipement","text":"<p>Nous avons a notre disposition un switch CISCO Catalyst 3750-X Serie 24 ports stacker ce qui nous fais donc un coeur de r\u00e9seau 48 ports.</p> <ul> <li>Le stacking : </li> </ul> <p>Pour effectuer le stacking nous avons du brancher les switch avec le cable satck et il ont fusionn\u00e9e automatiquement.</p> <p>Il est organiser comme suit : Les port du premier switch sont en 1/0/1 - 1/0/24 et les port du second sont en 2/0/1 - 2/0/24.</p>"},{"location":"Conf-Coeur-de-r%C3%A9seau/#la-configuration","title":"La configuration","text":""},{"location":"Conf-Coeur-de-r%C3%A9seau/#reset-du-switch","title":"Reset du switch","text":"<p>Afin  de commencer notre infrastructure sur un \u00e9quipement propre nous l'avons reenitialiser en effexctuant un appuy long sur le boutton \"Mode\" en facade du switch. </p>"},{"location":"Conf-Coeur-de-r%C3%A9seau/#configuration-basique","title":"Configuration basique","text":"<p>Afin de pouvoir securiser notre switch nous avons cr\u00e9er un nouvel utilisateur admin grace au commandes: </p> <pre><code>Switch&gt; enable\nSwitch# conf t\nSwitch(config)# username &lt;nomutilisateur&gt; privilege &lt;15&gt; secret &lt;motdepasse&gt;\nSwitch(config)# line vty 0 15\nSwitch(config-line)# login local\nSwitch(config-line)# exit\nOrleans(config)# exit\nOrleans&gt; write\n</code></pre> <p>Une fois le nouvel utilisateur cr\u00e9er nous pouvons renomer le switch avec cette commande :</p> <pre><code>Switch&gt; enable\nSwitch# conf t\nSwitch(config)# hostname Orleans\nOrleans(config)# exit\nOrleans&gt; write\n</code></pre>"},{"location":"Conf-Coeur-de-r%C3%A9seau/#configurer-le-ssh","title":"Configurer le SSH","text":"<p>Pour configurer le SSH nous allons initialiser le VLAN de management 230 (10.10.10.0/24) L'ip du switch sera 10.10.10.1 il faudra donc dans le switch entrer les commandes suivantes:</p> <pre><code>Orleans&gt; enable\nOrleans# conf t\nOrleans(config)# interface vlan 230\nOrleans(config-if)# description Management\nOrleans(config-if)# ip address 10.10.10.1 255.255.255.0\nOrleans(config-if)# exit\nOrleans(config)# Interface GigabitEthernet1/0/1\nOrleans(config-if)# switchport mode access\nOrleans(config-if)# Switchport access vlan 230\nOrleans(config-if)# exit\nOrleans(config)# exit\nOrleans&gt; write\n</code></pre> <p>Nous pouvons maintenant configurer le SSH :</p> <pre><code>Orleans&gt; enable\nOrleans# conf t\nOrleans(config)# ip domain-name orleans.sportludique.fr\nOrleans(config)# crypto key generate rsa 2048\nOrleans(config)# ip ssh version 2\nOrleans(config)# ip ssh time-out 60\nOrleans(config)# ip ssh authentication-retries 2\nOrleans(config)# enable secret password &lt;mot de passe&gt;\nOrleans(config)# exit\nOrleans&gt; write mem\n</code></pre> <p>"},{"location":"Conf-Coeur-de-r%C3%A9seau/#creation-des-vlans","title":"Cr\u00e9ation des VLANS","text":"<pre><code>Orleans&gt; enable\nOrleans# conf t\nOrleans(config)# interface vlan231\nOrleans(config-if)# description DMZ\nOrleans(config-if)# no ip address\nOrleans(config-if)#exit\nOrleans(config)# interface vlan232\nOrleans(config-if)# description Serveur\nOrleans(config-if)# ip address 172.28.32.254 255.255.255.0\nOrleans(config-if)#exit\nOrleans(config)# interface vlan235\nOrleans(config-if)# description R&amp;D\nOrleans(config-if)# ip address 172.28.35.254 255.255.255.0\nOrleans(config-if)#exit\nOrleans(config)# interface vlan236\nOrleans(config-if)# description WiFiVisiteurs\nOrleans(config-if)# ip address 172.28.36.254 255.255.255.0\nOrleans(config-if)#exit\nOrleans(config)# interface vlan237\nOrleans(config-if)# description WiFiEmployes\nOrleans(config-if)# ip address 172.28.37.254 255.255.255.0\nOrleans(config-if)#exit\nOrleans(config)# interface vlan238\nOrleans(config-if)# description Intercom_coeur_SN210\nOrleans(config-if)# ip address 192.168.20.1 255.255.255.0\nOrleans(config-if)#exit\nOrleans(config)# interface vlan239\nOrleans(config-if)# description Intercom\nOrleans(config-if)# no ip address\nOrleans(config-if)#exit\nOrleans(config)# exit\nOrleans&gt; write mem\n</code></pre>"},{"location":"Conf-Coeur-de-r%C3%A9seau/#ajout-de-la-passerelle-par-default","title":"Ajout de la passerelle par d\u00e9fault","text":"<pre><code>Orleans&gt; enable\nOrleans# conf t\nOrleans(config)# ip default-gateway 192.168.20.254\nOrleans(config)# ip classeless\nOrleans(config)# ip route 0.0.0.0 192.168.20.254\nOrleans(config)# exit\nOrleans&gt; write mem\n</code></pre>"},{"location":"Conf-Debian/","title":"Debian","text":"<p>Utilisation de Nutanix pour cr\u00e9er la VM Ddebian 12 afin de</p> <p>creer les users sudo adduser \"nom-user\"</p> <ul> <li> <p>commande config DNS : /etc/resolv.conf </p> </li> <li> <p>commande config du depot :  sudo nano /etc/apt/sources.list</p> </li> </ul> <p>donc on avait erreur pour faire apt update donc modif \u00e0 l'aide de ce depot :  <code>deb http://deb.debian.org/debian/ bookworm main non-free-firmware contrib non-free</code></p> <ul> <li>configuration ssh : sudo apt install openssh-server</li> </ul>"},{"location":"Conf-Firewall/","title":"Firewall","text":""},{"location":"Conf-Firewall/#acceder-a-linterface-de-gestion-du-firewall-stormshield","title":"Acc\u00e9der \u00e0 l\u2019interface de gestion du firewall Stormshield","text":"<p>Pour commancer la configuraton de notre Firewall nous devons le configurer en passant par l'interface web avec l'IP 10.0.0.254 une page de connection s'affiche et nous pouvons maintenant effectuer les modifications que l'on souhaite.</p>"},{"location":"Conf-Firewall/#pour-configurer-les-interfaces","title":"Pour configurer les interfaces.","text":"<p>Pour rappel voici le shema r\u00e9seau :</p> <p></p> <p>Nous devons adapter la configuration pour les deux Firewall </p> <p>Dans le menu :  configuration/RESEAU/Interfaces</p> <p>Nous avons ensuite modifier les interfaces :</p>"},{"location":"Conf-Firewall/#pour-le-sn-210","title":"Pour le SN-210","text":"<p>L'interface in a toujours l'IP 10.0.0.254/24 (IP de base) en cas de perte de controle sur le Firewall cependant nous avons ajouter les vlan d'interconnection (238) et de management (230) avec des IP referencer sur PHPIPAM</p> <p>L'interface out ne dispose pas de vlan mais est configurer avec l'ip du r\u00e9seau de la DMZ </p> <p>L'interface DMZ-Priv\u00e9e Comporte l'IP 192.168.145.254/24</p> <p>Pour le SN 310 nous avons effectuer les m\u00eames modification mais adapt\u00e9 sa position.</p>"},{"location":"Conf-Routeurs/","title":"Le materiel","text":"<p>Pour fournir l'acc\u00e9s internet a notre infrastructure nous avons a notre disposition deux routeurs cisco 1921.</p> <ul> <li> <p>L'un fournira internet haut d\u00e9bit en Fibre, il sera notre connection primaire</p> </li> <li> <p>L'autre fournira internet en ADSL il, sera notre connection secondaire.</p> </li> </ul> <p>Pour effectuer une priorit\u00e9 sur le trafic nous allons utiliser le protocole HSRP.</p>"},{"location":"Conf-Routeurs/#renitialisation-des-routeurs","title":"R\u00e9nitialisation des routeurs","text":"<p>Pour avoir acc\u00e9es a notre routeur en port serie sur nos machines linux il faut installer et configurer le minicom avec les commandes suivantes :</p> <pre><code>    sudo apt install minicom \n    sudo minicom - s\n    /dev/tty\n</code></pre> <p>Nous pouvons maintenant nous connecter a notre routeur grace au port serie et au logiciel putty</p> <p>Une fois connecter nous allons aller dans le ROMmon avec ctrl pause </p> <p>Le ROMon s'ouvre et nous pouvons y entrer la commande :</p> <pre><code>    confreg 0x2142\n    reset\n</code></pre>"},{"location":"Conf-Routeurs/#configuration-du-ssh","title":"Configuration du SSH","text":"<p>Afin de mettre en place notre SSH nous devons d'abord mettre en place notre VLAN de management en cr\u00e9ant une interface virtuelle sur notre interface interne</p> <pre><code>    RTR-ORLEANS-FIBRE&gt;enable\n    RTR-ORLEANS-FIBRE# conf \n    RTR-ORLEANS-FIBRE(config)# interface GigabitEthernet 0/1.230\n    RTR-ORLEANS-FIBRE(config-subif)# description VLAN Management\n    RTR-ORLEANS-FIBRE(config-subif)# encapsulation dot1q 230\n    RTR-ORLEANS-FIBRE(config-subif)# ip address 10.10.10.200 255.255.255.0\n    RTR-ORLEANS-FIBRE(config-subif)# exit\n    RTR-ORLEANS-FIBRE(config)#\n\n    RTR-ORLEANS-FIBRE(config)# ip domain-name orleans.sportludique.fr\n    RTR-ORLEANS-FIBRE(config)# crypto key generate rsa 2048\n    RTR-ORLEANS-FIBRE(config)# ip ssh version 2\n    RTR-ORLEANS-FIBRE(config)# ip ssh time-out 60\n    RTR-ORLEANS-FIBRE(config)# ip ssh authentication-retries 2\n    RTR-ORLEANS-FIBRE(config)# enable secret password &lt;mot de passe&gt;\n    RTR-ORLEANS-FIBRE(config)# exit\n    RTR-ORLEANS-FIBRE&gt; write mem\n</code></pre>"},{"location":"Conf-Routeurs/#configuration-des-interfaces","title":"Configuration des interfaces","text":"<ul> <li> <p>Interface WAN (out):</p> <pre><code>RTR-ORLEANS-FIBRE&gt;enable\nRTR-ORLEANS-FIBRE#conf\nRTR-ORLEANS-FIBRE#(config)interface GigabitEthernet 0/0\nRTR-ORLEANS-FIBRE#(config-if)description FIBRE\nRTR-ORLEANS-FIBRE#(config-if)ip addresse 183.44.45.1 255.255.255.252\nRTR-ORLEANS-FIBRE#(config-if)exit\nRTR-ORLEANS-FIBRE#(config)exit\nRTR-ORLEANS-FIBRE# write mem\n</code></pre> </li> <li> <p>Interface LAN (in): </p> <pre><code>RTR-ORLEANS-FIBRE&gt;enable\nRTR-ORLEANS-FIBRE#conf\nRTR-ORLEANS-FIBRE#(config)interface GigabitEthernet 0/1\nRTR-ORLEANS-FIBRE#(config-if)no ip address\nRTR-ORLEANS-FIBRE#(config-if)exit\nRTR-ORLEANS-FIBRE#(config)interface GigabitEthernet 0/1.239\nRTR-ORLEANS-FIBRE#(config-if) encapsulation dot1Q 239\nRTR-ORLEANS-FIBRE#(config-if) ip address 192.168.10.200 255.255.255.0\nRTR-ORLEANS-FIBRE#(config-if) exit\nRTR-ORLEANS-FIBRE#(config) exit\nRTR-ORLEANS-FIBRE# write mem\n</code></pre> </li> </ul>"},{"location":"Conf-Routeurs/#routage","title":"Routage","text":"<ul> <li>Etablire les routes par d\u00e9fault<pre><code>RTR-ORLEANS-FIBRE#(config)ip route 0.0.0.0 0.0.0.0 221.87.145.1\nRTR-ORLEANS-FIBRE#(config)ip route 172.28.32.0 255.255.224.0 192.168.10.1\nRTR-ORLEANS-FIBRE#(config)ip route 192.168.45.0 255.255.255.0 192.168.10.1\nRTR-ORLEANS-FIBRE#(config)ip route 192.168.145.0.255.255.255.0 255.255.255.0 192.168.10.1\n</code></pre> </li> </ul>"},{"location":"Conf-Routeurs/#nat","title":"NAT","text":"<p>Le NAT agit au niveau des routeurs ou des pare-feu. Lorsqu\u2019un appareil du r\u00e9seau local envoie une requ\u00eate vers Internet, le routeur qui fait du NAT remplace l\u2019adresse IP priv\u00e9e de l\u2019appareil par une adresse IP publique avant de transmettre la requ\u00eate. Lorsque la r\u00e9ponse revient de l\u2019ext\u00e9rieur, le NAT r\u00e9tablit l\u2019adresse IP priv\u00e9e d\u2019origine et redirige la r\u00e9ponse vers le bon appareil \u00e0 l\u2019int\u00e9rieur du r\u00e9seau local.</p> <ul> <li> <p>Sur l'interface WAN (OUT):</p> <pre><code>RTR-ORLEANS-FIBRE&gt;enable\nRTR-ORLEANS-FIBRE#conf\nRTR-ORLEANS-FIBRE#(config)interface GigabitEthernet 0/0\nRTR-ORLEANS-FIBRE#(config-if) ip nat outside\nRTR-ORLEANS-FIBRE#(config-if) exit\nRTR-ORLEANS-FIBRE#(config)ip nat source list 1 interface GigabitEthernet 0/0 overload\nRTR-ORLEANS-FIBRE#(config) exit\nRTR-ORLEANS-FIBRE# write mem\n</code></pre> </li> <li> <p>Sur l'interface LAN (IN):</p> <pre><code>RTR-ORLEANS-FIBRE&gt;enable\nRTR-ORLEANS-FIBRE#conf\nRTR-ORLEANS-FIBRE#(config)interface, GigabitEthernet 0/1.239\nRTR-ORLEANS-FIBRE#(config-if) ip nat inside\nRTR-ORLEANS-FIBRE#(config-if) exit\nRTR-ORLEANS-FIBRE#(config) exit\nRTR-ORLEANS-FIBRE# write mem\n</code></pre> </li> </ul>"},{"location":"Conf-Routeurs/#acl-access-list","title":"ACL (Access List)","text":"<ul> <li>Une Access Control List (ACL) est un ensemble de r\u00e8gles utilis\u00e9es en informatique pour contr\u00f4ler le trafic r\u00e9seau. Elles d\u00e9finissent quelles connexions sont autoris\u00e9es ou bloqu\u00e9es en fonction de crit\u00e8res comme l\u2019adresse IP, le protocole (TCP, UDP), ou les num\u00e9ros de ports. <p>Les ACLs sont couramment utilis\u00e9es dans les routeurs et pare-feu pour s\u00e9curiser les r\u00e9seaux en g\u00e9rant quels paquets de donn\u00e9es peuvent passer. <pre><code>    RTR-ORLEANS-FIBRE&gt;enable\n    RTR-ORLEANS-FIBRE#conf\n    RTR-ORLEANS-FIBRE#(config)access-list 1 permit 172.28.32.0 0.0.31.255\n    RTR-ORLEANS-FIBRE#(config)access-list 1 permit 192.168.45.0 0.0.0.255\n    RTR-ORLEANS-FIBRE#(config)access-list 1 permit 192.168.145.0 0.0.0.255\n    RTR-ORLEANS-FIBRE#(config)exit\n    RTR-ORLEANS-FIBRE#write mem\n</code></pre>"},{"location":"Conf-Wi-Fi/","title":"Configuration d'une borne Wi-Fi Aruba","text":"<p>Pour que nos utilisateurs puissent avoir acc\u00e9es a internet sur leurs ordinateurs sans avoir acc\u00e9es a une prise murale nous allons leurs mettre en place un service Wi-Fi accessible avec leurs identifiant de connection sur l'Active Directory.</p>"},{"location":"Conf-Wi-Fi/#nps","title":"NPS","text":"<p>Le serveur NPS effectue de fa\u00e7on centralis\u00e9e les processus d\u2019authentification, d\u2019autorisation et de gestion des comptes pour les connexions sans fil, par commutateur d\u2019authentification, par acc\u00e8s \u00e0 distance et r\u00e9seau priv\u00e9 virtuel (VPN). Lorsque vous utilisez NPS en tant que serveur RADIUS. </p> <p>NPS permet d'assurer que seules les bonnes personnes ont acc\u00e8s au r\u00e9seau, et qu'elles respectent les r\u00e8gles d\u00e9finies. </p> <p>Il utilise souvent un protocole appel\u00e9 RADIUS pour communiquer avec les \u00e9quipements r\u00e9seau (comme les bornes Wi-Fi ou les pare-feu) afin d\u2019appliquer les r\u00e8gles d\u2019acc\u00e8s. </p>"},{"location":"Conf-Wi-Fi/#installer-un-serveur-nps-network-policy-server-a-laide-du-gestionnaire-de-serveur","title":"Installer un serveur NPS (Network Policy Server) \u00e0 l\u2019aide du Gestionnaire de serveur :","text":"<p>Sur le WINDOWS SERVER de notre infra, dans le Gestionnaire de serveur, cliquez sur: G\u00e9rer, puis sur Ajouter des r\u00f4les et des fonctionnalit\u00e9s.  </p> <p>Dans S\u00e9lectionner le type d\u2019installation, v\u00e9rifiez que Installation bas\u00e9e sur un r\u00f4le ou une fonctionnalit\u00e9 est s\u00e9lectionn\u00e9, puis cliquez sur Suivant. </p> <p>Dans S\u00e9lectionner le serveur de destination, v\u00e9rifiez que S\u00e9lectionner un serveur du pool de serveurs est s\u00e9lectionn\u00e9. Dans Pool de serveurs, v\u00e9rifiez que l\u2019ordinateur local est s\u00e9lectionn\u00e9. Cliquez sur Suivant. </p> <p>Dans S\u00e9lectionner des r\u00f4les de serveurs, dans R\u00f4les, s\u00e9lectionnez Services de strat\u00e9gie et d\u2019acc\u00e8s r\u00e9seau. Une bo\u00eete de dialogue s\u2019ouvre pour demander s\u2019il faut ajouter les fonctionnalit\u00e9s requises pour les services de strat\u00e9gie et d\u2019acc\u00e8s r\u00e9seau. Cliquez sur Ajouter les fonctionnalit\u00e9s, puis sur Suivant </p> <p>Dans S\u00e9lectionner des fonctionnalit\u00e9s, cliquez sur Suivant, puis dans Services de strat\u00e9gie et d\u2019acc\u00e8s r\u00e9seau, v\u00e9rifiez les informations fournies et cliquez sur Suivant. </p> <p>Dans S\u00e9lectionner des services de r\u00f4le, cliquez sur Serveur NPS (Network Policy Server). Dans Ajouter les fonctionnalit\u00e9s requises pour le serveur NPS (Network Policy Server), cliquez sur Ajouter des fonctionnalit\u00e9s. Cliquez sur Suivant. </p> <p>Dans Confirmer les s\u00e9lections d\u2019installation, cliquez sur Red\u00e9marrer automatiquement le serveur de destination, si n\u00e9cessaire. Lorsque vous \u00eates invit\u00e9 \u00e0 confirmer ce choix, cliquez sur Oui, puis sur Installer. La page de progression de l\u2019installation indique l\u2019\u00e9tat du processus d\u2019installation.  </p>"},{"location":"Conf-Wi-Fi/#configuration-de-nps-comme-serveur-radius","title":"Configuration de NPS comme serveur RADIUS","text":"<p>Dans la console NPS, cliquer sur Strat\u00e9gies de r\u00e9seau</p> <p>Ajouter une nouvelle strat\u00e9gie d'acc\u00e8s : </p> <pre><code>    a: Nommer la strat\u00e9gie (ex: \"acc\u00e8s employ\u00e9s\")\n\n\n    b: D\u00e9finir les conditions (ex: groupe d'utilisateurs AD autoris\u00e9s, type de connexion)\n</code></pre> <p></p> <pre><code>    c: Configurer la m\u00e9thode d'authentification (PEAP, EAP-TLS, etc.)\n</code></pre> <p>Dans Clients et serveurs RADIUS, ajouter un client RADIUS (ex: borne Wi-Fi) en renseignant : </p> <pre><code>    a: Son adresse IP ou nom d'h\u00f4te\n\n    b: Une cl\u00e9 secr\u00e8te partag\u00e9e pour l'authentification\n</code></pre>"},{"location":"Conf-Wi-Fi/#service-adcs-gestionnaire-de-certificat","title":"Service ADCS (gestionnaire de certificat)","text":"<p>Installer le service dans \u201cajout role et fonctionnalit\u00e9\u201d de l\u2019AD </p> <p>Puis, avancez jusqu'\u00e0 l'\u00e9tape \"Services de r\u00f4le\" o\u00f9 vous n'aurez qu'\u00e0 cocher \"Autorit\u00e9 de certification\".  Suivant </p> <p>Poursuivez la configuration via le lien \"Configurer les services de certificats Active Directory\" visible dans le Gestionnaire de serveur. </p> <p>Pour service de role s\u00e9lectionner encore autorit\u00e9 de certification</p> <p>S\u00e9lectionnez ensuite \"Autorit\u00e9 de certification d'entreprise\" et poursuivez. Ce choix est fait, car nous sommes en environnement Active Directory et que nous utilisons qu'un seul serveur. Dans le cas o\u00f9 une hi\u00e9rarchie de CA est mise en place, cette premi\u00e8re autorit\u00e9 de certification sera configur\u00e9e en tant que CA autonome, puis la CA interm\u00e9diaire d\u00e9ploy\u00e9e sur un second serveur, serait une autorit\u00e9 de certification d'entreprise. </p> <p>Pour le type d\u2019ac s\u00e9lectionner autorit\u00e9 de certificat racine Cl\u00e9 priv\u00e9ee avec chiffrement SH512  Nom de l\u2019AC (capture d\u2019ecran)  Periode de validit\u00e9 : peut importe exemple 10 ann\u00e9es Laissez par d\u00e9faut les chemins indiqu\u00e9s pour stocker la base de donn\u00e9es des certificats et les logs associ\u00e9s. Poursuivez directement. (capture)  Faire configurer </p>"},{"location":"Conf-Wi-Fi/#joindre-cette-methode-connection-a-un-ssid-et-un-vlan","title":"Joindre cette methode connection a un SSID et un VLAN","text":"<p>Pour pouvoir administrer notre borne Wi-Fi nous avons du cr\u00e9er une pool DHCP car elle ne prend pas en charge l'IP fixe pour le management:</p> <p></p> <p>Ensuite nous avons activer une r\u00e9servation d'adresse IP pour l'adresse MAC de la borne Aruba</p> <p></p> <p>On peut ensuite se connecter via le l'addresse IP de la borne</p> <p></p> <p>Nous allons cr\u00e9er un SSID pour les employ\u00e9s</p> <p></p> <p>On lui attribut le VLAN adapt\u00e9</p> <p></p> <p>Puis dans l'onglet securit\u00e9 on serlectionne le mode gestion de cl\u00e9s WPA-2-Entreprise puis nous allons ajouter notre serveur d'authentification</p> <p></p> <p>Cr\u00e9ation du serveur d'authentification (Windows Serveur) </p> <p></p> <p>Puis finition en validant la cr\u00e9ation du Wi-FI</p> <p></p>"},{"location":"Conf-Windows-Serveur/","title":"Windows Serveur","text":"<p>Utilisation de Nutanix pour cr\u00e9er la VM Windows Server pour l'AD afin qu'il y est un controleur de domaine. </p> <p>Nous avons ensuite mit serveur DNS primaire, DHCP.</p> <p>Cr\u00e9er le domaine en lan.orleans.sportludique.fr</p> <p>Et cr\u00e9ation des 3 sessions administrateur </p>"},{"location":"Conf-portailcaptif/","title":"Configuration d'un portail captif sur stormshield","text":""},{"location":"DNS/","title":"DNS Redirrecteur","text":""},{"location":"DNS/#activer-le-service-dns-redirrecteur","title":"Activer le service DNS redirrecteur","text":""},{"location":"DNS/#dans-le-gestionnaire-de-serveur","title":"Dans le Gestionnaire de serveur","text":"<pre><code>    Dans le menu \"Outils\" selectionner \"DNS\"\n    Selectionner le dossier \"Redirecteurs\" puis \"Propri\u00e9t\u00e9s\"\n    Clique sur \"Modifier\" \n    Puis dans la fen\u00e9tre qui s'ouvre entrer l'addresse IP de votre redirrecteur\n\n    Dans le menu \"Intergfaces\"\n    Selectionner l'IP du serveur configurer pr\u00e9c\u00e9dement\n    Puis valider\n</code></pre> <p>Le DNS redirrecteur va permettre de communique avec le DNS qui a la propri\u00e9t\u00e9 sur le domaine SportLudique.fr Il permettra de resoudre les noms de domaines</p>"},{"location":"DNS/#dans-les-reglages-reseau-du-serveur","title":"Dans les r\u00e9glages r\u00e9seau du Serveur","text":"<pre><code>    Dans le \"Centre R\u00e9seau et Partage\"\n    Selectionner \"Propri\u00e9t\u00e9s\"\n    Puis \"IPv4\"\n    Dans le param\u00e9tre Serveur DNS Pr\u00e9f\u00e9r\u00e9 entrer l'adresse IP du serveur DNS local du serveur\n</code></pre>"},{"location":"DNS/#nslookup","title":"nslookup","text":"<p>Le nslookup il permet de voir la resolution DNS </p>"},{"location":"DNSDEB/","title":"Configuration du DNS Zone Publique","text":"<p>Pour mettre en place notre server DNS nous allons utiliser une machine DEBIAN vierge. </p> <p>Nous allons dans un premier temps mettre \u00e0 jour notre machine avec les commandes : </p> <pre><code>    Sudo apt update\n</code></pre> <p>Puis nous pouvons installer le logiciel n\u00e9cessaire au d\u00e9ploiement du service DNS :</p> <pre><code>    Sudo apt install bind9 bind9-utils\n</code></pre> <p>Une fois que nous avons t\u00e9l\u00e9charger les fichiers n\u00e9cessaires nous allons modifier le fichier :  </p> <pre><code>    /etc/bind/db.orleans.sportludique.fr\n</code></pre> <p>Et le faire correspondre \u00e0 l\u2019image ci-dessous :</p> <p></p> <p>TTL : (Time To Live) indique en seconde le temps que mettra la machine client \u00e0 refaire une demande au serveur dns.  NS : (Name Server) D\u00e9finit les serveurs DNS autoritaires pour un domaine.  MX : (Mail Exchange) Sp\u00e9cifie les serveurs responsables de la r\u00e9ception des e-mails.  A :  = (Address Record) Associe un nom de domaine \u00e0 une adresse IPv4.  WWW : (World Wide web) D\u00e9signe un serveur Web dans ce r\u00e9seau.   Mail : D\u00e9signe un serveur mail dans ce r\u00e9seau. </p>"},{"location":"DNSDEB/#ensuite-nous-allons-modifier-ce-fichier","title":"Ensuite nous allons modifier ce fichier:","text":"<pre><code>    /etc/bind/named.conf.local\n</code></pre> <p>Et le faire correspondre \u00e0 l\u2019image ci-dessous : </p> <p></p> <p>Il sagit de la zone directe que l'on g\u00e8re localement donc il est important si l'on veut qu\u2019il s\u2019interroge lui-m\u00eame.</p> <p>Il faut modifier par la suite ce fichier : </p> <pre><code>    Fichier /etc/bind/named.conf.options\n</code></pre> <p></p> <p>recursion yes : Le serveur DNS peut effectuer des requ\u00eates r\u00e9cursives pour r\u00e9soudre des noms de domaines externes (utile pour les clients locaux). </p> <p>allow-query : Sp\u00e9cifie les clients autoris\u00e9s \u00e0 effectuer des requ\u00eates DNS. </p> <p>Forwarders : D\u00e9finit les serveurs DNS externes vers lesquels les requ\u00eates non r\u00e9solues localement sont redirig\u00e9es. </p> <p>dnssec-validation : Active ou d\u00e9sactive la validation DNSSEC (Domain Name System Security Extensions), qui ajoute une couche de s\u00e9curit\u00e9 pour v\u00e9rifier que les r\u00e9ponses DNS proviennent d'une source fiable. </p> <p>Listen \u2013 on : le r\u00e9seau o\u00f9 il \u00e9coute </p> <pre><code>    Fichier /etc/resolv.conf\n</code></pre> <p></p> <p>Il est important mettre une adresse IP locale pour qu\u2019il puisse s\u2019interroger lui-m\u00eame ainsi que son nom de domaine. </p>"},{"location":"Dovecot/","title":"Dovecot","text":""},{"location":"HSRP/","title":"HSRP","text":""},{"location":"HSRP/#definition","title":"D\u00e9finition :","text":"<p>(Hot Standby Router Protocol) est un protocole de redondance d\u00e9velopp\u00e9 par CISCO. </p> <p>Il permet d\u2019assurer une haute disponibilit\u00e9 des passerelles par d\u00e9faut (ou routeurs) dans un r\u00e9seau local. Il est con\u00e7u pour \u00e9viter un point de d\u00e9faillance unique dans le r\u00e9seau en offrant une solution de basculement automatique lorsque la passerelle principale devient indisponible. </p> <p>Il permet \u00e0 plusieurs routeurs ou passerelles de collaborer afin de pr\u00e9senter une seule passerelle virtuelle aux h\u00f4tes du r\u00e9seau. Cela garantit que si le routeur actif (qui achemine r\u00e9ellement le trafic) \u00e9choue, un routeur de secours prend automatiquement le relais sans que les h\u00f4tes ne s\u2019en aper\u00e7oivent.</p> <p>Dans notre cas nous avons d\u00e9finit en routeur prioritaire la FIBRE et la passerelle par d\u00e9faut sera 192.168.10.254</p>"},{"location":"HSRP/#configuration-du-hsrp","title":"Configuration du HSRP","text":"<p>dans les deux routeurs la configuration est difff\u00e9rente, nous allons alors commencer par le routeur FIBRE (Primaire) grace au commandes suivantes :</p> <pre><code>    RTR-ORLEANS-FIBRE&gt;enable\n    RTR-ORLEANS-FIBRE#conf t\n    RTR-ORLEANS-FIBRE#(config)interface GigabitEthernet 0/1.239\n    RTR-ORLEANS-FIBRE#(config-if) standby 1 ip 192.168.10.254\n    RTR-ORLEANS-FIBRE#(config-if) standby 1 priority 110\n    RTR-ORLEANS-FIBRE#(config-if) standby 1 preempt\n    RTR-ORLEANS-FIBRE#(config-if) exit\n    RTR-ORLEANS-FIBRE#(config) exit\n    RTR-ORLEANS-FIBRE# write mem\n</code></pre> <p>Configuration dans le routeur ADSL (Secondaire) :</p> <pre><code>    RTR-ORLEANS-ADSL&gt;enable\n    RTR-ORLEANS-ADSL#conf t\n    RTR-ORLEANS-ADSL#(config)interface GigabiEethernet 0/1.239\n    RTR-ORLEANS-ADSL#(config-if)standby 1 ip 192.168.10.254\n    RTR-ORLEANS-ADSL#(config-if)standby 1 preempt\n    RTR-ORLEANS-ADSL#(config-if)exit\n    RTR-ORLEANS-ADSL#(config)exit\n    RTR-ORLEANS-ADSL#write mem\n</code></pre>"},{"location":"InstallLDAP/","title":"Installation de LDAP","text":""},{"location":"Loadbalencing/","title":"Load Balencing","text":"<p>Le Load Balancing permet de r\u00e9partir le trafic sur plusieurs serveurs pour une meilleure r\u00e9partition de la charge, sur Nginx </p>"},{"location":"Loadbalencing/#1-creer-un-fichier-de-configuration-pour-le-load-balancer","title":"1. Cr\u00e9er un fichier de configuration pour le Load Balancer","text":"<p>Cr\u00e9ation du fichier dans le repertoire conf.d pour la configuration du Load Balancer : </p> <pre><code>  sudo nano /etc/nginx/conf.d/load-balancer.conf\n</code></pre>"},{"location":"Loadbalencing/#2-configuration-du-load-balancer","title":"2. Configuration du Load Balancer","text":"<p>Ajoute la configuration suivante pour cr\u00e9er un Load Balancer : </p> <p>Dans /etc/nginx/conf.d/load-balancer.conf</p> <pre><code>  upstream backend {\n     ip_hash ;\n     server 192.168.45.9 max_fails=3 fail_timeout=1s;\n     server 192.168.45.10 max_fails=3 fail_timeout=1s;\n  }\n</code></pre>"},{"location":"Loadbalencing/#3-activer-la-configuration","title":"3. Activer la configuration","text":"<p>Comme pour le Reverse Proxy, cr\u00e9e un lien symbolique dans <code>sites-enabled</code> : </p> <pre><code>  sudo ln -s /etc/nginx/conf.d/load-balancer.conf /etc/nginx/sites-enabled/\n</code></pre>"},{"location":"Loadbalencing/#4-tester-la-configuration","title":"4. Tester la configuration","text":"<pre><code>  sudo nginx -t\n</code></pre>"},{"location":"Loadbalencing/#5-redemarrer-nginx","title":"5. Red\u00e9marrer Nginx","text":"<p>Applique les changements en red\u00e9marrant Nginx : </p> <pre><code>  sudo systemctl restart nginx\n</code></pre>"},{"location":"Loadbalencing/#6-verification","title":"6. V\u00e9rification","text":"<p>V\u00e9rifier que le Load Balancer fonctionne en acc\u00e9dant \u00e0 l'IP de du serveur Nginx. Le trafic devrait \u00eatre r\u00e9parti entre les serveurs configur\u00e9s dans le <code>upstream</code>. </p>"},{"location":"Modifdovecot/","title":"Modification Dovecot","text":""},{"location":"Modifpostfix/","title":"Modification Postfix","text":""},{"location":"NGINXinstall/","title":"Installation et configuration de Nginx sur Debian/Ubuntu","text":""},{"location":"NGINXinstall/#1-mise-a-jour-du-systeme","title":"1. Mise \u00e0 jour du syst\u00e8me","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n</code></pre>"},{"location":"NGINXinstall/#2-installation-de-nginx","title":"2. Installation de Nginx","text":"<p>Installez Nginx avec la commande suivante :</p> <pre><code>sudo apt install nginx \n</code></pre>"},{"location":"NGINXinstall/#3-verification-du-service-nginx","title":"3.  V\u00e9rification du service Nginx","text":"<p>V\u00e9rifiez si le service Nginx s\u2019est bien lanc\u00e9 apr\u00e8s l\u2019installation :</p> <pre><code>sudo systemctl status nginx\n</code></pre> <p>Si n\u00e9cessaire, d\u00e9marrez-le manuellement :</p> <pre><code>sudo systemctl start nginx\n</code></pre>"},{"location":"NGINXinstall/#4-verification-depuis-un-navigateur","title":"4. V\u00e9rification depuis un navigateur","text":"<p>Acc\u00e9dez \u00e0 l\u2019adresse IP <code>http://192.168.45.14</code> dans le navigateur.</p> <p>Vous devriez voir la page par d\u00e9faut de Nginx : \"Welcome to nginx!\"</p>"},{"location":"NGINXinstall/#5-commandes-utiles-pour-gerer-nginx","title":"5. Commandes utiles pour g\u00e9rer Nginx","text":"Action Commande Red\u00e9marrer Nginx <code>sudo systemctl restart nginx</code> Recharger la configuration <code>sudo systemctl reload nginx</code> Activer Nginx au d\u00e9marrage <code>sudo systemctl enable nginx</code> D\u00e9sactiver au d\u00e9marrage <code>sudo systemctl disable nginx</code>"},{"location":"NGINXinstall/#6-arborescence-des-fichiers-nginx","title":"6. Arborescence des fichiers Nginx","text":"<ul> <li>Fichier principal de config : <code>/etc/nginx/nginx.conf</code></li> <li> <p>R\u00e9pertoires de configuration des sites :</p> <ul> <li>Sites disponibles : <code>/etc/nginx/sites-available/</code></li> <li>Sites activ\u00e9s : <code>/etc/nginx/sites-enabled/</code></li> </ul> </li> <li> <p>R\u00e9pertoire racine du site par d\u00e9faut : <code>/var/www/html</code></p> </li> </ul>"},{"location":"NGINXinstall/#7-tester-la-configuration","title":"7. Tester la configuration","text":"<p>Avant de red\u00e9marrer Nginx apr\u00e8s des modifications </p> <p>Tester la configuration :</p> <pre><code>sudo nginx -t\n</code></pre> <p>Si la commande retourne \"syntax is ok\" et \"test is successful\", </p> <p>Pour recharger la configuration :</p> <pre><code>sudo systemctl reload nginx\n</code></pre>"},{"location":"Postfix/","title":"Configuration Postfix (smtp)(utilisateur en local)","text":"<p>Pour mettre en place notre server Mail nous avons utilis\u00e9 une machine DEBIAN vierge. </p> <pre><code>    sudo apt install postfix \u2013y\n</code></pre> <p>N\u2019oubliez surtout pas d\u2019installer les logs </p> <pre><code>    Sudo apt install rsyslog\n</code></pre> <p>Ceci permet d\u2019avoir les erreurs dans le fichier /var/log/mail.log ou m\u00eame les mails envoy\u00e9s. </p> <p>Ensuite on peut configurer le paquet postfix avec cette commande : </p> <pre><code>    Dpkg-reconfigure postfix\n</code></pre> Valeur Signification Configuration mail type Site internet  Nom courrier mail.orleans.sportludique.fr Destinataire des mails pour root  Autres destinataires orleans.sportludique.fr Forcer la mise \u00e0 jour de la sync de la file d'attente Oui Lan 127.0.0.0/8 127.28.32.0/19 Limite de la boite mail 0 Protocole internet IPV4 <p>Maintenant nous allons \u00e9diter le fichier:</p> <pre><code>    /etc/postfix/main.cf\n</code></pre> <p></p> <p>Il nous faut imperativement v\u00e9rifier les lignes suivantes : </p> <p>Myhostname : Nom d\u2019h\u00f4te complet du serveur </p> <p>Mydomain : Nom de domaine principal </p> <p>My destination : D\u00e9finit les domaines locaux pour lesquels ce serveur accepte les mails </p> <p>Mynetworks : R\u00e9seaux et adresses Ip qui sont autoris\u00e9es \u00e0 envoyer des mails via ce serveur sans authentification </p> <p>Home_mailbox : R\u00e9pertoire o\u00f9 les emails des utilisateurs locaux seront stock\u00e9s  </p> <p>Ensuite on relance le service :</p> <pre><code>    Sudo systemctl restart postfix\n</code></pre> <p>Ensuite pour tester la conf on peut utiliser la commande : </p> <pre><code>    sudo postconf \u2013n\n</code></pre> <p>Vos courrier vont apparaitre dans le fichier home de l\u2019utilisateur: </p> <pre><code>    /home/Maildir\n</code></pre>"},{"location":"Remote-Desktop-Protocol/","title":"RDP","text":"<p>commande : dans le terminale de commande sudo apt install freerdp-x11</p> <p>afin d'ouvrir la session ; xfrrrdp /u:Administrateur /v:10.10.10.15 /sec:nla /p:P@ssw0rd123456!</p>"},{"location":"Reverseproxy/","title":"Reverse Proxy","text":""},{"location":"Reverseproxy/#1-creer-un-fichier-de-configuration-pour-le-site","title":"1. Cr\u00e9er un fichier de configuration pour le site","text":"<p>Navigue vers le r\u00e9pertoire <code>sites-available</code> de Nginx et cr\u00e9e un nouveau fichier de configuration : </p> <p>sudo nano /etc/nginx/sites-available/site-orleans-sportludique </p> <p>Il faudra faire pareil pour l\u2019autre site\u202fmais avec un autre intitul\u00e9\u202f </p> <pre><code>    server {\n            listen 80;\n\n            server_name www.orleans.sportludique.fr;\n            return 301 https://Shost$request.uri;\n\n    }\n\n    server {\n            listen 443 ssl ;\n            server_name www.orleans.sportludique.fr;\n\n            ssl_certificate /etc/ssl/certificats-sitesweb/certificat_siteweb.crt; \n            ssl_certificate_key /etc/ssl/certificats-sitesweb/privatekey.key;\n\n            location / {\n            proxy_pass http://backend;\n            include /etc/nginx/proxy_params;\n            }\n    }\n</code></pre>"},{"location":"Reverseproxy/#2-configuration-du-reverse-proxy","title":"2. Configuration du Reverse Proxy","text":"<p>Dans ce fichier, ajoute la configuration suivante pour configurer le reverse proxy du site 1 et du site 2 avec une diff\u00e9rence pour chacun que j\u2019ai indiqu\u00e9 ci dessous : </p> <pre><code>    server {\n\n            listen 80;\n\n            index index.html index.htm index.nginx-debian.html; POUR LE SITE2\n\n            server_name www.orleans.sportludique.fr;\n\n            return 301 https://$host$request_uri;\n\n    }\n\n    server {\n\n            listen 443 ssl;\n\n            server_name www.orleans.sportludique.fr;\n\n\n\n            ssl_certificate /etc/ssl/certificats-sitesweb/certificat_siteweb.crt;\n\n            ssl_certificate_key /etc/ssl/certificats-sitesweb/privatekey.key;\n\n\n\n            location / {\n\n            proxy_pass http://backend;\n\n            include /etc/nginx/proxy_params;\n\n            proxy_set_header Host $host;\n\n            proxy_set_header X-Real-IP $remote_addr;\n\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n            proxy_set_header X-Forwarded-Proto $scheme;\n\n            }\n\n    }\n</code></pre>"},{"location":"Reverseproxy/#3-activer-le-site","title":"3. Activer le site","text":"<p>Cr\u00e9e un lien symbolique dans le r\u00e9pertoire <code>sites-enabled</code> pour activer la configuration: </p> <pre><code>    sudo ln -s /etc/nginx/sites-available/site-orleans-sportludique /etc/nginx/sites-enabled/nomduliensymbolique\n</code></pre>"},{"location":"Reverseproxy/#4-tester-la-configuration","title":"4. Tester la configuration","text":"<pre><code>    sudo nginx -t\n</code></pre> <ol> <li>Red\u00e9marrer Nginx </li> </ol> <p>Si la configuration est correcte, red\u00e9marre Nginx pour appliquer les changements : </p> <pre><code>    sudo systemctl restart nginx\n</code></pre> <ol> <li>V\u00e9rifier le fonctionnement du Reverse Proxy</li> </ol> <p>V\u00e9rifier en acc\u00e9dant \u00e0 l'IP de ton serveur Nginx depuis un navigateur. On devrait \u00eatre redirig\u00e9 vers le serveur configur\u00e9 dans le <code>proxy_pass</code>.</p>"},{"location":"R%C3%A9seau/","title":"R\u00e9seau","text":"<p>Rappel du contexte :</p> <p>SportLudique, sp\u00e9cialis\u00e9e dans les articles de sport non convenionnels, est r\u00e9partie sur quatre sites : Chartres, Tours, Orl\u00e9ans et Ch\u00e2teauroux. L'infrastructure r\u00e9seau est g\u00e9r\u00e9e par le d\u00e9partement SISR, responsable de l'exploitation du parc informatique et des projets r\u00e9seaux.</p> <p>Les besoins :</p> Nombre d'utilisateurs 60 Nombre de PC fixes 80 Nombre de PC portables 03 Nombre de serveurs 11"},{"location":"R%C3%A9seau/#shema-reseau","title":"Sh\u00e9ma r\u00e9seau","text":""},{"location":"SSL/","title":"Certificat SSL avec autorit\u00e9 de certification","text":"<p>Nous allons configurer et activer via notre serveur Apache le protocole de chiffrement SSL/TLS afin que les requetes circulent de fa\u00e7on confidentielle sur internet. Lorsque la communication est effectu\u00e9e via cette couche de transport chiffr\u00e9e, un \u00ab\u202fs\u202f\u00bb est ajout\u00e9 au nom du protocole\u202f: : http://www.orleans.sportludique.fr  devient https://www.orleans.sportludique.fr . </p> <p>Ce certificat est n\u00e9cessaire pour transf\u00e9rer la cl\u00e9 publique du serveur ainsi que son identit\u00e9 afin d'initier une communication via TLS.  </p>"},{"location":"SSL/#1-verification-de-linstallation-dopenssl","title":"1. V\u00e9rification de l\u2019installation d\u2019OpenSSL","text":"<p>Dans ce cas nous sommes notre propre autorit\u00e9 de certification. </p> <pre><code>openssl version\n</code></pre> <p>Editer le fichier /etc/ssl/openssl.cnf  Ce fichier d\u00e9crit le comportemant que g\u00e8re openSSL.  C'est dans ce fichier que nous imposerons les champs SAN (Subject Alternative Names). </p> <p></p>"},{"location":"SSL/#2-organisation","title":"2. Organisation","text":""},{"location":"SSL/#3-creation-de-la-cle-privee-du-serveur-web","title":"3. Cr\u00e9ation de la cl\u00e9 priv\u00e9e du serveur web :","text":"<pre><code>openssl genrsa 2048 &gt; siteweb/keys/privatekey.key\n</code></pre> <p>commande pour v\u00e9rifier le contenu\u202f: </p> <pre><code>openssl ec -in privatekey.key -text -noout\n</code></pre>"},{"location":"SSL/#4-generation-dune-demande-de-certificat-pour-le-serveur-web","title":"4. G\u00e9n\u00e9ration d'une demande de certificat pour le serveur web :","text":"<pre><code>openssl req -new -key siteweb/keys/privatekey.key &gt; siteweb/requests_certificats/demande.csr -config /etc/ssl/openssl.cnf\n</code></pre> <p>diff\u00e9rents champs seront demand\u00e9s </p> <p>Si on veut v\u00e9rifier notre demande on peut faire la commande\u202f:  </p> <pre><code>openssl req -in siteweb/requests_certificats/demande.csr -noout -text\n</code></pre> <p></p> <p>Cr\u00e9ation du certificat de l'autorit\u00e9 de certification </p>"},{"location":"SSL/#5-creation-de-la-cle-privee","title":"5. Cr\u00e9ation de la cl\u00e9 priv\u00e9e\u202f:","text":"<pre><code>openssl genrsa -des3 2048 &gt; private_ca.key\n</code></pre> <p>une pass phrase sera demand\u00e9  </p>"},{"location":"SSL/#6-creation-du-certificat-pour-la-duree","title":"6. Cr\u00e9ation du certificat pour la dur\u00e9e :","text":"<pre><code>openssl req -new -x509 -days 365 -key private_ca.key &gt; autorite/certificats/ca.crt\n</code></pre> <p>champs seront demand\u00e9s comme pr\u00e9c\u00e9demment mais attention ce sont des informations concernant l'autorit\u00e9.  Elles doivent \u00eatre diff\u00e9rentes des informations saisies pr\u00e9c\u00e9demment pour le site web. Ici on g\u00e8re notre propre autorit\u00e9 de certification qui est fictive.</p> <p>Signer la demande de certificat : </p> <pre><code>openssl x509 -req -in /home/orleans/ssl/siteweb/requests_certificats/demande.csr -out /home/orleans/ssl/siteweb/certificats/certificat_siteweb.crt -CA /home/orleans/ssl/autorite/certificats/ca.crt -CAkey /home/orleans/ssl/private_ca.key -CAcreateserial -CAserial /home/orleans/ssl/autorite/ca.srl -extfile /etc/ssl/openssl.cnf -extensions v3_req\n</code></pre> <p>V\u00e9rifier son contenu  :</p> <pre><code>openssl x509 -in siteweb/certificats/certificat_siteweb.crt -noout -text\n</code></pre> <p></p>"},{"location":"SSL/#7-configuration-du-serveur-web","title":"7. Configuration du serveur web","text":"<p>Copier le fichier <code>/etc/apache2/sites-available/default-ssl.conf</code> dans son dossier d'origine mais avec le nom du site web donc www.orleans .conf </p> <p>(en conservant l'extension .conf pour la commande a2ensite) </p> <ul> <li>Adapter\u202f: DocumentRoot et ServerName </li> <li>Modifier : SSLCertificateFile et SSLCertificatekeyfile et rediriger le port 443 (Vagrantfile). </li> </ul> <p>Activer le module SSL, activer le site, et red\u00e9marrer le service comme demand\u00e9\u202f: </p> <pre><code>a2enmod ssl\n</code></pre> <p>Acc\u00e9der au site et accepter le certificat et afficher ses informations </p> <p>Penser \u00e0 rajouter le certificat dans le navigateur  </p>"},{"location":"Serveur-Apache/","title":"Serveur Apache","text":"<p>Pour permettre l'acc\u00e8s \u00e0 notre site web, nous l'avons h\u00e9berg\u00e9 sur un serveur Apache. Ce dernier a pour r\u00f4le de recevoir les requ\u00eates des navigateurs, qui sollicitent des pages web, de rechercher la page correspondante et de la renvoyer \u00e0 l'utilisateur.</p>"},{"location":"Serveur-Apache/#1-installation-dapache2","title":"1. Installation d'Apache2","text":"<pre><code>sudo apt install apache2\n</code></pre> <p>V\u00e9rifiez le statut du service Apache : </p> <pre><code>sudo systemctl status apache2\n</code></pre> <p>Testez l\u2019installation : Rendez-vous sur l\u2019adresse IP de la VM dans un navigateur pour voir la page de test Apache par d\u00e9faut (exemple\u202f: http://192.168.45.10). </p> <p>Nous devrions obtenir cette page\u202f: </p> <p></p>"},{"location":"Serveur-Apache/#2-configuration-du-site-web","title":"2. Configuration du site web","text":""},{"location":"Serveur-Apache/#creer-un-repertoire-pour-le-site-web","title":"Cr\u00e9er un r\u00e9pertoire pour le site web\u202f:","text":"<pre><code>sudo nano /var/www/html/index.html\n</code></pre>"},{"location":"Serveur-Apache/#definir-les-permissions","title":"D\u00e9finir les permissions :","text":"<pre><code>sudo chown -R www-data:www-data /var/www/orleans.sportludique.fr\n\nsudo chmod -R 755 /var/www/orleans.sportludique.fr\n</code></pre>"},{"location":"Serveur-Apache/#creer-un-fichier-de-configuration-apache-pour-le-site","title":"Cr\u00e9er un fichier de configuration Apache pour le site :","text":"<pre><code>sudo nano /etc/apache2/sites-available/www.orleans.conf\n</code></pre>"},{"location":"Serveur-Apache/#contenu-du-fichier","title":"Contenu du fichier :","text":"<p>serveur 1 : </p> <pre><code>&lt;VirtualHost *:443&gt;\n        ServerName 192.168.45.9       #192.168.45.10 pour le serveur 2\n\n        DocumentRoot /var/www/html/\n\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    SSLEngine on\n\n        SSLCertificateFile      /etc/ssl/certs/xxxxxx.crt\n        SSLCertificateKeyFile   /etc/ssl/private/xxxx.key\n\n    &lt;FilesMatch \"\\.(?:cgi|shtml|phtml|php)$\"&gt;\n            SSLOptions +StdEnvVars\n    &lt;/FilesMatch&gt;\n    &lt;Directory /usr/lib/cgi-bin&gt;\n            SSLOptions +StdEnvVars\n    &lt;/Directory&gt;\n        SSLProtocol -all +TLSv1.2 +TLSv1.3\n        SSLCipherSuite HIGH:!aNULL:!MD5\n        SSLHonorCipherOrder on\n\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"Serveur-Apache/#activer-le-site-et-recharger-apache","title":"Activer le site et recharger Apache :","text":"<pre><code>sudo a2ensite orleans.sportludique.fr\n</code></pre>"},{"location":"Serveur-DHCP/","title":"Serveur DHCP","text":""},{"location":"Serveur-DHCP/#mise-en-place-du-serveur-dhcp-pour-les-differents-vlans","title":"Mise en place du serveur DHCP pour les diff\u00e9rents VLANS","text":"Nom VLAN Management 230 R&amp;D 235 WiFi visiteurs 236 <p>Pour cela nous avons cr\u00e9er le serveur DHCP sur notre Windows Serveur.</p>"},{"location":"Serveur-DHCP/#dans-le-gestionnaire-de-serveur","title":"Dans le gestionnaire de Serveur","text":"<pre><code>  - Outils\n  - DHCP\n  - Selection du dommaine concern\u00e9 ainsi que le type d'IP\n  - Cliquer sur \"action\" puis \"nouvelle etendue\"\n</code></pre> <ul> <li>L'assistant de Nouvelle \u00e9tendue s'ouvre. </li> </ul>"},{"location":"Serveur-DHCP/#sur-lassistant","title":"Sur l'assistant :","text":"<pre><code>  - Nommer l'\u00e9tendue\n  - Ajouter les addresse IP de d\u00e9but et de fin\n  - (il est possible d'effectuer une exculusion pour une plage d'IP)\n  - On definit la dur\u00e9e du bail\n  - et enfin on valide les param\u00e9tres\n</code></pre>"},{"location":"Serveur-VPN/","title":"Serveur VPN OpenVPN","text":""},{"location":"Serveur-VPN/#installation-basique-openvpn","title":"Installation basique OpenVPN. `","text":"<pre><code>    sudo apt-get install openvpn\n    sudo apt-get install easy-rsa\n    make-cadir openvpn-ca &amp;&amp; cd  ~/openvpn-ca\n    sudo nano vars\n</code></pre>"},{"location":"Serveur-VPN/#modification-du-fichier-vars-en-ajoutant-ces-lignes","title":"Modification du fichier vars en ajoutant ces lignes :","text":"<pre><code>    set_var EASYRSA_REQ_COUNTRY     \"Fr\"\n    set_var EASYRSA_REQ_PROVINCE    \"Idf\"\n    set_var EASYRSA_REQ_CITY        \"Orleans\"\n    set_var EASYRSA_REQ_ORG         \"orleans.sportludique.fr\"\n    set_var EASYRSA_REQ_EMAIL       \"orleans.orleans.sportludique.fr\"\n    set_var EASYRSA_REQ_OU          \"labo\"\n    set_var EASYRSA_ALGO            rsa \n    set_var EASYRSA_CURVE           secp384r1\n    set_var EASYRSA_DIGEST          \"sha256\"\n    set_var EASYRSA_CA_EXPIRE       3650\n    set_var EASYRSA_CERT_EXPIRE     825\n    set_var EASYRSA_CRL_DAYS        180\n</code></pre>"},{"location":"Serveur-VPN/#nous-avons-enregistre-puis-entre-la-commande-afin-de-creer-le-fichier-pki","title":"nous avons enregistr\u00e9 puis entr\u00e9 la commande afin de cr\u00e9er le fichier PKI :","text":"<pre><code>    ./easyrsa init-pki\n</code></pre>"},{"location":"Serveur-VPN/#nous-allons-ensuite-generer-le-fichier-cacrt","title":"Nous allons ensuite g\u00e9n\u00e9rer le fichier ca.crt :","text":"<pre><code>    ./easyrsa build-ca nopass\n</code></pre>"},{"location":"Serveur-VPN/#nous-allons-egalement-generer-les-fichiers-serverkey-et-servercrt","title":"Nous allons \u00e9galement g\u00e9n\u00e9rer les fichiers server.key et server.crt :","text":"<pre><code>    ./easyrsa build-server-full server nopass\n</code></pre>"},{"location":"Serveur-VPN/#generation-du-fichier-crl","title":"G\u00e9n\u00e9ration du fichier CRL","text":"<pre><code>    ./easyrsa gen-crl\n</code></pre>"},{"location":"Serveur-VPN/#generation-du-fichier-takey","title":"G\u00e9n\u00e9ration du fichier ta.key :","text":"<pre><code>    sudo openvpn --genkey secret ta.key\n    D\u00e9placement des fichier :\n    sudo cp /usr/share/doc/openvpn/examples/sample-config-files/server.conf /etc/openvpn\n    sudo cp /openvpn-ca/pki/issued/server.crt /etc/openvpn/server/\n    sudo cp /openvpn-ca/pki/private/server.key /etc/openvpn/server/\n    sudo cp /openvpn-ca/pki/ca.crt /etc/openvpn/server/\n    sudo cp /openvpn-ca/ta.key /etc/openvpn/server/\n    sudo cp /openvpn-ca/pki/crl.pem /etc/openvpn/server/\n</code></pre>"},{"location":"Serveur-VPN/#modification-du-fichier-serverconf","title":"Modification du fichier server.conf :","text":"<pre><code>local 192.168.34.15 \nport 1194 \n;proto tcp \nproto udp \n;dev tap \ndev tun  \n;dev-node MyTap \nca server/ca.crt \ncert server/server.crt \nkey server/server.key  # This file should be kept secret \ndh none \ntopology subnet \nserver 10.8.0.0 255.255.255.0 \nifconfig-pool-persist /var/log/openvpn/ipp.txt   \n;server-bridge 10.8.0.4 255.255.255.0 10.8.0.50 10.8.0.100 \n;server-bridge \n;push \"route 192.168.10.0 255.255.255.0\" \n;push \"route 192.168.20.0 255.255.255.0\" \npush \"route 121.183.90.200 255.255.255.248\" \npush \"route 183.44.0.0 255.255.0.0\" \npush \"route 221.87.0.0 255.255.0.0\" \npush \"route 10.10.10.0 255.255.255.0\" \n;client-config-dir ccd \n;route 192.168.40.128 255.255.255.248 \n;client-config-dir ccd \n;route 10.9.0.0 255.255.255.252 \n;learn-address ./script \npush \"redirect-gateway def1 bypass-dhcp\" \n;push \"dhcp-option DNS 208.67.222.222\" \n;push \"dhcp-option DNS 208.67.220.220\" \npush \"dhcp-option DNS 121.183.90.205\" \n;client-to-client \n;duplicate-cn \nkeepalive 10 120 \ntls-auth server/ta.key 0 # This file is secret \ncipher AES-256-GCM \nauth SHA256\n;compress lz4-v2 \n;push \"compress lz4-v2\"  \n;comp-lzo \n;max-clients 100 \nuser root \ngroup root \npersist-key \npersist-tun \nstatus /var/log/openvpn/openvpn-status.log \n;log /var/log/openvpn/openvpn.log \n;mute 20 \nexplicit-exit-notify 1 \nmode server \ncrl-verify server/crl.pem \nremote-cert-tls client \ntls-version-min 1.2\n</code></pre>"},{"location":"Serveur-VPN/#redemmarage-du-service-et-creation-des-client-avec-les-commandes","title":"Red\u00e9mmarage du service et cr\u00e9ation des client avec les commandes :","text":"<pre><code>    cd ~/openvpn-ca\n    ./easyrsa build-client-full elouenn nopass\n</code></pre>"},{"location":"Serveur-VPN/#recuperation-des-fichiers-clients-grace-a-filezilla","title":"R\u00e9cuperation des fichiers clients grace \u00e0 FileZilla :","text":""},{"location":"Serveur-VPN/#creation-du-fichier-ovpn","title":"Cr\u00e9ation du fichier OVPN :","text":"<pre><code># Nous somme client et l'on peut recup\u00e9rer des \u00e9l\u00e9ments pouss\u00e9 par le serveur \nclient\n# Mettre comme sur le fichier server.conf \ndev tun\n# Protocol pour communiquer avec le serveur\nproto udp\n# Liste de vos serveur VPN et port (Mettre le domaine ou l'IP publique) \nremote 183.44.45.1 1194\n# Si plusieurs serveur sont d\u00e9fini on en choisi 1 au hasard.\n#remote-random\n# Aucune id\u00e9e de ce que \u00e7a fait\nresolv-retry infinite\n# N'utilise pas de port sp\u00e9cifique pour repondre\nnobind\n# On garde des \u00e9tat \u00e0 travers les restart\npersist-key\npersist-tun\n# On rajoute un controle pour s'assurer que le serveur de destination\n# poss\u00e8de bien un certificat de type serveur\nremote-cert-tls server\n# On configure les m\u00eame cipher que le serveur\ncipher AES-256-GCM\nauth SHA256\n# Le niveau de log\nverb 3\n# Pour une configuration inline des certificats\nkey-direction 1\nca ca.crt\ncert elouenn.crt\nkey elouenn.key\ntls-auth ta.key 1\n</code></pre>"},{"location":"Serveur-VPN/#tentative-de-connexion","title":"Tentative de connexion","text":"<p>Pour la premi\u00e9re tentative nous avons essay\u00e9 de nous connecter en local et au debut nous avions cette erreur : </p> <pre><code> 2024-12-17 11:06:26 us=114951 Authenticate/Decrypt packet error: packet HMAC authentication failed\n 2024-12-17 11:06:26 us=115088 TLS Error: incoming packet authentication failed from [AF_INET]10.10.10.17:39727 erreur possible\n</code></pre> <p>Nous avons donc modifi\u00e9 le fichier client.OVPN pour le mettre comme il est ci-dessus.</p> <p>Puis nous avons retest\u00e9 la connexion en local avec succ\u00e8s.</p> <p>nous pouvons donc test\u00e9 depuis l'infrastructure de Tours succes mais sans possibilit\u00e9 de joindre les \u00e9quipements li\u00e9s au r\u00e9seau local management.</p> <p>Solution : Cr\u00e9er des r\u00e8gles de NAT sur le serveur </p> <p>Nous avons donc acc\u00e8s au r\u00e9seaux management de notre entreprise depuis le r\u00e9seau local de tours.</p>"},{"location":"Serveur-VPN/#etape-suivant-mettre-le-vpn-accessible-depuis-le-vrai-web","title":"\u00c9tape suivant mettre le VPN accessible depuis le vrai WEB","text":""},{"location":"VLAN/","title":"VLAN","text":"<p>Afin de segmenter et diff\u00e9rencier les diff\u00e9rents p\u00f4les de notre organisation au sein de notre r\u00e9seau, nous avons adopt\u00e9 la technologie des VLANs (Virtual Local Area Networks). Cette approche nous permet d\u2019isoler les diff\u00e9rents sous-r\u00e9seaux de mani\u00e8re logique, facilitant ainsi la gestion du trafic, l\u2019am\u00e9lioration de la s\u00e9curit\u00e9, et l\u2019optimisation des performances r\u00e9seau en attribuant des ressources d\u00e9di\u00e9es \u00e0 chaque p\u00f4le.</p> <p>Notre plage d\u2019adresses IP est 172.28.32.0/19, ce qui nous offre une capacit\u00e9 d\u2019adressage suffisante pour couvrir les besoins de chaque segment de r\u00e9seau. Afin d\u2019assurer une gestion efficace de ces adresses et de maintenir une vue d\u2019ensemble actualis\u00e9e de notre infrastructure, nous avons mis en place un syst\u00e8me de IPAM (IP Address Management). Cet outil nous permet de r\u00e9f\u00e9rencer l\u2019ensemble des adresses IP, d\u2019attribuer les sous-r\u00e9seaux \u00e0 chaque VLAN de mani\u00e8re structur\u00e9e, et de garantir une mise \u00e0 jour continue de la configuration r\u00e9seau, notamment en cas de modifications ou d\u2019expansions. L\u2019IPAM joue un r\u00f4le crucial dans l\u2019optimisation de l\u2019allocation des adresses et dans la pr\u00e9vention des conflits d\u2019adressage.</p> Nom Vlan @ r\u00e9sau Masque Management 230 10.10.10.0 /24 DMZ Publique 231 192.168.45.1 /24 Serveurs 232 172.28.32.0 /24 LIBRE 233 192.168.33.0 /24          R&amp;D 235 172.28.35.0 /24 WiFI visiteurs 236 192.168.28.0 /24 LIBRE 237 172.28.37.0 /24 Interco SN210 Coeur 238 192.168.20.0 /24 Interco Routeurs SN310 239 192.168.10.0/24 /24"},{"location":"Vault-https/","title":"Configuration HTTPS avec un certificat auto-sign\u00e9","text":""},{"location":"Vault-https/#1-installation-dopenssl","title":"1. Installation d'OpenSSL","text":"<pre><code>sudo apt install openssl -y\n</code></pre>"},{"location":"Vault-https/#2-generation-dun-certificat-ssl-auto-signe","title":"2. G\u00e9n\u00e9ration d'un certificat SSL auto-sign\u00e9","text":"<pre><code>mkdir -p /opt/vaultwarden/ssl\ncd /opt/vaultwarden/ssl\n</code></pre> <p>Stockage du certificat et de la cl\u00e9 priv\u00e9e</p> <pre><code>openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout vaultwarden.key -out vaultwarden.crt\n</code></pre> <p>Rentrer les infos demand\u00e9es</p>"},{"location":"Vault-https/#3-modification-de-docker-composeyml-pour-activer-https","title":"3. Modification de docker-compose.yml pour activer HTTPS","text":"<p>Dans le fichier <code>/opt/vaultwarden/docker-compose.yml</code> :</p> <p>Ajouter dans la section environment :</p> <pre><code> - ROCKET_TLS={certs=\"/ssl/vaultwarden.crt\",key=\"/ssl/vaultwarden.key\"}\n</code></pre> <p>Modifier la section volumes :</p> <pre><code>volumes :\n  - ./data:/data\n  - ./ssl:/ssl\n</code></pre>"},{"location":"Vault-https/#4-redemarrer-vaultwarden","title":"4. Red\u00e9marrer Vaultwarden","text":"<pre><code>sudo docker-compose down\nsudo docker-compose up -d\n</code></pre>"},{"location":"Vault-https/#5-acces-et-configuration","title":"5. Acc\u00e8s et configuration","text":""},{"location":"Vault-https/#51-acces-a-vaultwarden","title":"5.1 Acc\u00e8s a Vaultwarden","text":"<p>HTTP : http://192.168.45.16:8080</p> <p>HTTPS : https://192.168.45.16:8080 (avec avertissement SSL) pour le wifi employ\u00e9 </p> <p>HTTP : http://10.10.10.27:8080</p> <p>HTTP : http://10.10.10.27:8080 en management</p> <p>(avec avertissement SSL)</p>"},{"location":"Vault-https/#52-acces-a-linterface-dadministration","title":"5.2 Acc\u00e8s \u00e0 l'interface d'administration","text":"<p>URL : https://10.10.10.27:8080/admin</p> <p>Se connecter avec ADMIN_TOKEN donc\u201dxxxx\u201d</p>"},{"location":"Vaultwarden/","title":"Installation de Docker et Docker Compose pour Vaultwarden","text":"<p>Un serveur DebianMettre \u00e0 jour le syst\u00e8me : sudo apt update &amp;&amp; sudo apt upgrade -y</p>"},{"location":"Vaultwarden/#1-installation-de-docker","title":"1. Installation de Docker","text":"<p>Ajout des d\u00e9p\u00f4ts officiels et installation :</p> <pre><code>sudo apt install -y apt-transport-https ca-certificates curl software-properties-common\n\ncurl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg]https://download.docker.com/linux/debian $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n\nsudo apt update\n\nsudo apt install -y docker-ce docker-ce-cli containerd.io\n</code></pre> <p>Activation et v\u00e9rification de Docker :</p> <pre><code>sudo systemctl enable --now docker docker --version\n</code></pre>"},{"location":"Vaultwarden/#2-installation-de-docker-compose","title":"2. Installation de Docker Compose","text":"<pre><code>sudo curl -L \"https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/\n\nsudo docker-compose\n\nsudo chmod +x /usr/local/bin/docker-compose\n\nsudo docker-compose --version\n</code></pre>"},{"location":"Vaultwarden/#3-installation-et-configuration-de-vaultwarden","title":"3. Installation et configuration de Vaultwarden","text":""},{"location":"Vaultwarden/#31-creation-du-dossier-vaultwarden","title":"3.1 Cr\u00e9ation du dossier Vaultwarden","text":"<pre><code>mkdir -p /opt/vaultwarden &amp;&amp; cd /opt/vaultwarden\n</code></pre>"},{"location":"Vaultwarden/#32-creation-du-fichier-docker-composeyml","title":"3.2 Cr\u00e9ation du fichier docker-compose.yml","text":"<p>Cr\u00e9er et \u00e9diter le fichier docker-compose.yml :</p> <pre><code>Ajouter le contenu suivant :\n    version: \"3\"\n    services:\n        vaultwarden:\n        image: vaultwarden/server:latest\n        container_name: vaultwarden\n        restart: unless-stopped\n    ports:\n        - \"8080:80\"\n        - \"3012:3012\"\n    volumes:\n        - ./data:/data\n    environment:\n        - WEBSOCKET_ENABLED=true\n        - SIGNUPS_ALLOWED=true #ce qui permet l\u2019activation pour cr\u00e9er un compte si on veut \u00e9viter que des utilisateurs se cr\u00e9er un compte changer par \u201cfalse\u201d\n        - ADMIN_TOKEN=\u201dxxxxxxx\u201d\n</code></pre> <p>Si on veut changer le mot de passe il suffit de le changer dans docker.compose.yml</p> <p>-&gt; Red\u00e9marrer Vaultwarden pour appliquer la modification avec les commandes suivantes : </p> <pre><code>sudo docker-compose up -d\n</code></pre> <p>-&gt; pour v\u00e9rifier que le conteneur tourne :</p> <pre><code>sudo docker ps\n</code></pre>"},{"location":"Vaultwarden/#33-creer-compte-utilisateur","title":"3.3 Cr\u00e9er compte utilisateur","text":"<p>On peut g\u00e9rer les utilisateurs via : https://192.168.45.16:8080/admin</p> <p>Pour cr\u00e9er un compte il y a trois possibilit\u00e9s : </p> <ul> <li>Interface admin : cliquer sur Vault en haut dans le menu ce qui va nous amener sur la page web et cr\u00e9er un compte</li> <li>Interface admin avec \u201center mail\u201d</li> <li>URL : https://192.168.45.16:8080/#/login</li> </ul> <p>On peut soit choisir de cr\u00e9er un compte (qui sera par la suite ajouter \u00e0 l\u2019interface en admin vu au-dessus) ou alors se connecter directement si un mot de passe \u00e0 d\u00e9j\u00e0 \u00e9t\u00e9 d\u00e9fini. </p> <p></p>"},{"location":"modifLDAP/","title":"Modification LDAP","text":""},{"location":"thunderbird/","title":"Thunderbird","text":""},{"location":"zabbix/","title":"\ud83d\udce1 Installation et Configuration de Zabbix pour la Supervision VPN &amp; SNMP","text":""},{"location":"zabbix/#1-installation-de-zabbix-sur-debian-12","title":"\ud83d\udd27 1. Installation de Zabbix sur Debian 12","text":""},{"location":"zabbix/#installation-de-mariadb","title":"\ud83d\uddc4\ufe0f Installation de MariaDB","text":"<pre><code>sudo apt install mariadb-server mariadb-client -y\nsudo systemctl start mariadb\nsudo systemctl enable mariadb\nsudo mysql_secure_installation\n</code></pre>"},{"location":"zabbix/#depot-zabbix","title":"\ud83d\udce6 D\u00e9p\u00f4t Zabbix","text":"<pre><code>wget https://repo.zabbix.com/zabbix/7.0/debian/pool/main/z/zabbix-release/zabbix-release_latest_7.2+debian12_all.deb\nsudo dpkg -i zabbix-release_latest_7.2+debian12_all.deb\nsudo apt update\n</code></pre>"},{"location":"zabbix/#installation-de-zabbix-et-dependances","title":"\ud83d\ude80 Installation de Zabbix et d\u00e9pendances","text":"<pre><code>sudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent\n</code></pre>"},{"location":"zabbix/#configuration-de-la-base-de-donnees","title":"\ud83d\uddc3\ufe0f Configuration de la base de donn\u00e9es","text":"<pre><code>sudo mysql -u root -p\n</code></pre> <pre><code>CREATE DATABASE zabbix CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;\nCREATE USER 'zabbix'@'localhost' IDENTIFIED BY 'VotreMotDePasseZabbix';\nGRANT ALL PRIVILEGES ON zabbix.* TO 'zabbix'@'localhost';\nSET GLOBAL log_bin_trust_function_creators = 1;\nEXIT;\n</code></pre> <pre><code>sudo zcat /usr/share/zabbix/sql-scripts/mysql/server.sql.gz | mysql --default-character-set=utf8mb4 -uzabbix -p zabbix\n</code></pre>"},{"location":"zabbix/#lancer-les-services","title":"\u25b6\ufe0f Lancer les services","text":"<pre><code>sudo systemctl restart zabbix-server zabbix-agent apache2\nsudo systemctl enable zabbix-server zabbix-agent apache2\n</code></pre>"},{"location":"zabbix/#2-configuration-des-agents-snmp","title":"\ud83d\udda7 2. Configuration des Agents SNMP","text":"<ul> <li>SNMP permet de superviser des \u00e9quipements r\u00e9seau (routeurs, switches, etc.)</li> <li>Pour SNMPv1 ou v2c, il suffit d\u2019indiquer la communaut\u00e9 (exemple : <code>zabbix</code>)</li> </ul>"},{"location":"zabbix/#3-probleme-avec-fping","title":"\u2699\ufe0f 3. Probl\u00e8me avec <code>fping</code> ?","text":"<pre><code>sudo apt-get install fping\nsudo rm -f /usr/sbin/fping6\nsudo ln -s /usr/bin/fping /usr/sbin/fping\nsudo systemctl restart zabbix-server\n</code></pre>"},{"location":"zabbix/#4-supervision-des-connexions-vpn","title":"\ud83d\udd10 4. Supervision des Connexions VPN","text":""},{"location":"zabbix/#script-de-comptage-des-clients-openvpn","title":"\ud83d\udcdc Script de comptage des clients OpenVPN","text":"<pre><code>sudo nano /usr/local/bin/get_openvpn_clients.sh\n</code></pre> <pre><code>#!/bin/bash\n\nSTATUS_FILE=\"/var/log/openvpn/openvpn-status.log\"\n\nif [ ! -f \"$STATUS_FILE\" ]; then\n  echo \"0\"\n  exit 1\nfi\n\ngrep -E \"10.8.0\" \"$STATUS_FILE\" | wc -l\n</code></pre> <pre><code>sudo chmod +x /usr/local/bin/get_openvpn_clients.sh\n</code></pre> <p>Modifier l\u2019agent Zabbix :</p> <pre><code>sudo nano /etc/zabbix/zabbix_agentd.conf\n</code></pre> <p>Ajouter :</p> <pre><code>UserParameter=vpn.connections,/usr/local/bin/get_openvpn_clients.sh\n</code></pre> <pre><code>sudo systemctl restart zabbix-agent\n</code></pre> <p></p>"},{"location":"zabbix/#5-gestion-des-snmp-traps","title":"\ud83d\udce5 5. Gestion des SNMP Traps","text":""},{"location":"zabbix/#installation-du-receiver","title":"\ud83d\udcc2 Installation du receiver","text":"<pre><code>sudo curl -o /usr/bin/zabbix_trap_receiver.pl https://git.zabbix.com/projects/ZBX/repos/zabbix/raw/misc/snmptrap/zabbix_trap_receiver.pl\nsudo chmod +x /usr/bin/zabbix_trap_receiver.pl\n</code></pre> <p>Modifier la ligne :</p> <pre><code>$SNMPTrapperFile = '/var/log/snmptrap/snmptrap.log';\n</code></pre> <p>Cr\u00e9er le r\u00e9pertoire :</p> <pre><code>sudo mkdir /var/log/snmptrap\nsudo chmod 777 /var/log/snmptrap\n</code></pre> <p></p>"},{"location":"zabbix/#fichier-de-configuration-snmp","title":"\ud83d\udcdc Fichier de configuration SNMP","text":"<pre><code>sudo nano /etc/snmp/snmptrapd.conf\n</code></pre> <p>Ajouter :</p> <pre><code>authCommunity execute zabbix\nperl do \"/usr/bin/zabbix_trap_receiver.pl\";\ntraphandle default /usr/bin/zabbix_trap_receiver.pl\n</code></pre>"},{"location":"zabbix/#rotation-des-logs","title":"\ud83d\udd01 Rotation des logs","text":"<pre><code>sudo nano /etc/logrotate.d/snmptrap\n</code></pre> <p>Contenu :</p> <pre><code>/var/log/snmptrap/snmptrap.log {\n    weekly\n    rotate 12\n    compress\n    delaycompress\n    missingok\n    notifempty\n}\n</code></pre>"},{"location":"zabbix/#demarrage-du-service-snmp","title":"\u25b6\ufe0f D\u00e9marrage du service SNMP","text":"<pre><code>sudo systemctl stop snmptrapd snmptrapd.socket\nsudo systemctl start snmptrapd\nsudo systemctl enable snmptrapd\n</code></pre>"},{"location":"zabbix/#6-configuration-de-zabbix-pour-snmp-traps","title":"\ud83e\udde9 6. Configuration de Zabbix pour SNMP Traps","text":"<pre><code>sudo nano /etc/zabbix/zabbix_server.conf\n</code></pre> <p>Configurer :</p> <pre><code>SNMPTrapperFile=/var/log/snmptrap/snmptrap.log\nStartSNMPTrapper=1\n</code></pre> <pre><code>sudo systemctl restart zabbix-server\n</code></pre> <p></p> <p>\ud83c\udf89 Vous \u00eates maintenant pr\u00eat \u00e0 superviser vos connexions VPN et \u00e9quipements SNMP via Zabbix !</p>"}]}